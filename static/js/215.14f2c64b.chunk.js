"use strict";(self.webpackChunkreact_film_randomize=self.webpackChunkreact_film_randomize||[]).push([[215],{9215:(e,i,s)=>{s.r(i),s.d(i,{default:()=>U});var t=s(2791),r=s(1332),n=s(6196),l=s(1614),_=s(6151),a=s(5660),o=s(6674),m=s(976),c=s(7324),p=s(1087),d=s(9230);const u="modal_modal__lhkbI",F="modal_active__euz6F",x="modal_modalContent__OX5JB";var Z=s(184);const h=e=>{let{children:i,visible:s,setVisible:t}=e;const r=[u];s&&r.push(F);const n=[x];return s&&n.push(F),(0,Z.jsx)("div",{className:r.join(" "),onClick:()=>t(!1),children:(0,Z.jsx)("div",{className:n.join(" "),onClick:e=>e.stopPropagation(),children:i})})};var f=s(7689),W=s(8254),j=s(2362),v=s(9877),A=s(2419),N=s(9823),b=s(872),g=s(5585);const I=e=>{let{user:i,filmSession:s,setFilmSession:r}=e;const{lobbyAllFilms:n,setLobbyAllFilms:l,socket:_}=(0,t.useContext)(c.Z),[a,m]=(0,t.useState)(!0),[p,d]=(0,t.useState)(!1),[u,F]=(0,t.useState)(""),[x,h]=(0,t.useState)(1);(0,t.useEffect)((()=>{_.on("responseNewFilm",(e=>l(e)))}),[n,l,_]),(0,t.useEffect)((()=>{_.on("updateUserDisconnectedFilms",(e=>l(e)))}),[n,l,_]),(0,t.useEffect)((()=>{0===n.length&&d(!0)}),[]);const f=(0,t.useRef)(null);return(0,Z.jsxs)("div",{className:j.Z.FilmFormWrapper,children:[(0,Z.jsx)(o.Z,{timeout:{exit:250},nodeRef:f,in:p,unmountOnExit:!0,onEnter:()=>m(!1),onExited:()=>m(!0),classNames:{enterActive:j.Z.enterActive,enterDone:j.Z.enterDone,exitActive:j.Z.exitActive,exitDone:j.Z.exitDone},children:(0,Z.jsxs)("div",{ref:f,className:j.Z.FormWrapper,children:[(0,Z.jsxs)("form",{className:j.Z.FormWrapper__form,children:[(0,Z.jsx)("input",{required:!0,minLength:1,maxLength:32,className:j.Z.inputTitle,type:"text",onChange:e=>F(e.target.value),placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u043b\u044c\u043c\u0430",value:u}),(0,Z.jsxs)("div",{className:j.Z.counterWrapp,children:[(0,Z.jsx)(v.Z,{className:j.Z.counterWrapp__plus,onClick:()=>{x<=9&&h((e=>e+1))},children:(0,Z.jsx)(A.Z,{})}),(0,Z.jsx)("div",{className:j.Z.counterWrapp__display,children:x}),(0,Z.jsx)(v.Z,{className:j.Z.counterWrapp__minus,onClick:()=>{x>=2&&h((e=>e-1))},children:(0,Z.jsx)(g.Z,{})})]}),(0,Z.jsx)(v.Z,{id:"AAA",onClick:()=>{const e={userID:i.id,lobbyID:i.lobbyID,socketID:_.id,id:Date.now(),option:u,optionSize:11-x,value:x,chance:1,quantity:Math.floor(110-10*x)};F(""),h(1),r([...s,e]),_.emit("newFilm",e)},className:j.Z.success,size:"small","aria-label":"add",children:(0,Z.jsx)(b.Z,{})})]}),(0,Z.jsx)(v.Z,{onClick:()=>{d(!1),F("")},className:j.Z.openInput,size:"small","aria-label":"add",children:(0,Z.jsx)(N.Z,{className:j.Z.openInput_icon})})]})}),a&&(0,Z.jsx)(v.Z,{onClick:()=>d(!0),className:j.Z.openInput,size:"small","aria-label":"add",children:(0,Z.jsx)(A.Z,{className:j.Z.openInput_icon})})]})};var C=s(1286),D=s(7247);const y=e=>{let{film:i,userLocal:s}=e;const{lobbyAllFilms:r,setLobbyAllFilms:n,numbersLobby:l,socket:_}=(0,t.useContext)(c.Z),[a,o]=(0,t.useState)(!1),[m,p]=(0,t.useState)(i.option),[d,u]=(0,t.useState)(i.value);(0,t.useEffect)((()=>{_.on("responeFilmDelete",(e=>n(e)))}),[r,n,_]),(0,t.useEffect)((()=>{_.on("responeFilmUpdate",(e=>n(e)))}),[r,n,_]);const F=Math.round(i.quantity/l.length*100);return(0,Z.jsx)("div",{className:W.Z.filmWrapp,children:a?(0,Z.jsx)("div",{className:W.Z.FormWrapper,children:(0,Z.jsxs)("form",{className:W.Z.FormWrapper__form,children:[(0,Z.jsx)("input",{maxLength:32,className:W.Z.inputTitle,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:m,onChange:e=>p(e.target.value)}),(0,Z.jsxs)("div",{className:W.Z.counterWrapp,children:[(0,Z.jsx)(v.Z,{className:W.Z.counterWrapp__plus,onClick:()=>{d<=9&&u((e=>e+1))},children:(0,Z.jsx)(A.Z,{})}),(0,Z.jsx)("div",{className:W.Z.counterWrapp__display,children:d}),(0,Z.jsx)(v.Z,{className:W.Z.counterWrapp__minus,onClick:()=>{d>=2&&u((e=>e-1))},children:(0,Z.jsx)(g.Z,{})})]}),(0,Z.jsxs)("div",{className:W.Z.formButtons,children:[(0,Z.jsx)(v.Z,{color:"info",className:W.Z.FormWrapper__edit,size:"small","aria-label":"edit",onClick:e=>{const s=r.map((e=>i.id===e.id?{...e,option:m,optionSize:11-d,value:d,quantity:Math.floor(110-10*d)}:e));_.emit("filmUpdate",s,i),o(!1)},children:(0,Z.jsx)(b.Z,{className:W.Z.edit__icon})}),(0,Z.jsx)(v.Z,{className:W.Z.FormWrapper__close,onClick:()=>o(!1),size:"small","aria-label":"add",children:(0,Z.jsx)(N.Z,{className:W.Z.close__icon})})]})]})}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("h2",{className:W.Z.filmWrapp__title,children:i.option}),i.userID===s.id?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(v.Z,{color:"info",className:W.Z.edit,size:"small","aria-label":"edit",onClick:()=>o(!0),children:(0,Z.jsx)(C.Z,{className:W.Z.filmWrapp__edit__icon})}),(0,Z.jsx)(v.Z,{size:"small",className:W.Z.filmWrapp__remove,onClick:e=>{_.emit("filmDelete",i)},children:(0,Z.jsx)(D.Z,{className:W.Z.filmWrapp__remove__icon})})]}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(v.Z,{style:{opacity:"0",cursor:"default"},color:"info",className:W.Z.edit,size:"small","aria-label":"edit"}),(0,Z.jsx)(v.Z,{style:{opacity:"0",cursor:"default"},size:"small",className:W.Z.filmWrapp__remove})]}),(0,Z.jsxs)("div",{className:W.Z.chanceWrapp,children:[(0,Z.jsxs)("p",{className:W.Z.filmFactor,children:[i.value," | "]}),(0,Z.jsxs)("p",{className:W.Z.filmChance,children:["| ",F," %"]})]})]})})},S=e=>{let{user:i,userLocal:s,filmSession:r,setFilmSession:n}=e;const{lobbyAllFilms:l}=(0,t.useContext)(c.Z),[_,p]=(0,t.useState)();return(0,t.useMemo)((()=>p(l.filter((e=>e.userID===i.id)))),[l]),(0,Z.jsxs)("div",{className:m.Z.userWrapper,children:[(0,Z.jsx)("div",{className:m.Z.userWrapper__title,children:i.userName}),(0,Z.jsx)(a.Z,{component:"div",children:_&&_.map((e=>(0,Z.jsx)(o.Z,{classNames:{enterActive:W.Z.enterActive,enterDone:W.Z.enterDone,exitActive:W.Z.exitActive},timeout:{exit:250},children:(0,Z.jsx)(y,{film:e,userLocal:s})},e.id)))}),i.id===s.id?(0,Z.jsx)(I,{user:i,filmSession:r,setFilmSession:n}):null]})};function k(e,i){const[s,r]=(0,t.useState)((()=>{const s=sessionStorage.getItem(i);return s?JSON.parse(s):e}));return(0,t.useEffect)((()=>{sessionStorage.setItem(i,JSON.stringify(s))}),[s]),[s,r]}const U=()=>{const{lobbyAllFilms:e,setLobbyAllFilms:i,setLobby:s,socket:u}=(0,t.useContext)(c.Z),[F,x]=(0,t.useState)(!1),[W,j]=(0,t.useState)(""),[v,A]=(0,t.useState)([]),[N,b]=k([],"sessionUser"),[g,I]=k([],"sessionFilms"),C=(0,f.UO)();(0,t.useEffect)((()=>{if("userName"in N){const e={...N,socketID:u.id},i=g.map((e=>({...e,socketID:u.id})));u.emit("UserReconection",e,i)}else x(!0)}),[u]),(0,t.useEffect)((()=>{u.on("responseUserReconection",(e=>{A(e)}))}),[i,u,e]),(0,t.useEffect)((()=>{u.emit("join",C.id),u.on("userConnected",(e=>console.log(e))),u.on("responseNewUser",((e,s)=>{A(e),i(s)})),u.on("updateUserDisconnected",(e=>A(e)))}),[u,N]);const{t:D}=(0,d.$G)();return(0,Z.jsx)(n.Z,{children:(0,Z.jsxs)("div",{className:r.Z.FilmsAddingPage__background,children:[(0,Z.jsxs)(l.Z,{maxWidth:"lg",sx:{display:"flex",flexDirection:"column"},children:[(0,Z.jsxs)("div",{className:r.Z.titleContainer,children:[(0,Z.jsx)("h1",{children:D("addingPage.rules.rules")}),(0,Z.jsx)("p",{children:D("addingPage.rules.added")}),(0,Z.jsx)("p",{children:D("addingPage.rules.selected")}),(0,Z.jsx)(_.Z,{className:r.Z.adding__button,color:"inherit",onClick:()=>{sessionStorage.removeItem("sessionUser"),sessionStorage.removeItem("sessionFilms"),u.close()},children:(0,Z.jsx)(p.OL,{to:"/Home",children:"\u0412\u044b\u0439\u0442\u0438"})})]}),(0,Z.jsx)(a.Z,{component:"div",className:r.Z.filmConteinerWrapp__users,children:v&&v.map((e=>(0,Z.jsx)(o.Z,{classNames:{enterActive:m.Z.enterActive,enterDone:m.Z.enterDone,exitActive:m.Z.exitActive},timeout:{exit:250},children:(0,Z.jsx)(S,{user:e,userLocal:N,filmSession:g,setFilmSession:I})},e.id)))}),(0,Z.jsx)(_.Z,{className:r.Z.adding__button,color:"inherit",children:(0,Z.jsx)(p.OL,{to:"/Games/".concat(C.id),children:D("addingPage.button")})})]}),(0,Z.jsxs)(h,{visible:F,setVisible:x,children:[(0,Z.jsx)("h2",{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c"}),(0,Z.jsx)("input",{type:"text",value:W,onChange:e=>j(e.target.value)}),(0,Z.jsx)("button",{onClick:()=>{const e={lobbyID:C.id,id:Date.now()+1,socketID:u.id,userName:W};b(e),x(!F),u.emit("newUser",e)},children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c"})]})]})})}},6196:(e,i,s)=>{s.d(i,{Z:()=>l});var t=s(9202),r=(s(2791),s(184));const n={initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50}},l=e=>{let{children:i}=e;return(0,r.jsx)(t.E.div,{variants:n,initial:"initial",animate:"animate",exit:"exit",transition:{duration:.3},children:i})}},2362:(e,i,s)=>{s.d(i,{Z:()=>t});const t={FilmFormWrapper:"_AddFilmForm_FilmFormWrapper__M-GbX",enterActive:"_AddFilmForm_enterActive__MW4-8",enterDone:"_AddFilmForm_enterDone__D06vH",exitActive:"_AddFilmForm_exitActive__F8l4-",exitDone:"_AddFilmForm_exitDone__0lpXd",FormWrapper:"_AddFilmForm_FormWrapper__fokB4",FormWrapper__form:"_AddFilmForm_FormWrapper__form__uqWVl",counterWrapp:"_AddFilmForm_counterWrapp__g4Cdj",counterWrapp__plus:"_AddFilmForm_counterWrapp__plus__8pEeR",counterWrapp__display:"_AddFilmForm_counterWrapp__display__T0Emp",counterWrapp__minus:"_AddFilmForm_counterWrapp__minus__+inRa",inputTitle:"_AddFilmForm_inputTitle__MUgKh","neon-1":"_AddFilmForm_neon-1__lb4oA",success:"_AddFilmForm_success__RvgqZ",openInput:"_AddFilmForm_openInput__7DTSB",openInput_icon:"_AddFilmForm_openInput_icon__ZxYSU"}},8254:(e,i,s)=>{s.d(i,{Z:()=>t});const t={enterActive:"_FilmItem_enterActive__p6s7V",enterDone:"_FilmItem_enterDone__wM-+q",exitActive:"_FilmItem_exitActive__S1ZNV",filmWrapp:"_FilmItem_filmWrapp__fGCTq",FormWrapper:"_FilmItem_FormWrapper__xrfvW",FormWrapper__form:"_FilmItem_FormWrapper__form__tZ5QS",inputTitle:"_FilmItem_inputTitle__5MtYn","neon-1":"_FilmItem_neon-1__8ci1R",counterWrapp:"_FilmItem_counterWrapp__5jHft",counterWrapp__plus:"_FilmItem_counterWrapp__plus__Nkzj9",counterWrapp__display:"_FilmItem_counterWrapp__display__hRYDf",counterWrapp__minus:"_FilmItem_counterWrapp__minus__2ESiU",formButtons:"_FilmItem_formButtons__JHK3O",FormWrapper__edit:"_FilmItem_FormWrapper__edit__SmpMB",edit__icon:"_FilmItem_edit__icon__bRBa6",success:"_FilmItem_success__3TmSd",FormWrapper__close:"_FilmItem_FormWrapper__close__LABHF",chanceWrapp:"_FilmItem_chanceWrapp__iUzNm",filmChance:"_FilmItem_filmChance__yAszh",filmFactor:"_FilmItem_filmFactor__jKYN3",filmWrapp__value:"_FilmItem_filmWrapp__value__RAzEO",filmWrapp__title:"_FilmItem_filmWrapp__title__gIT8r",filmWrapp__chance:"_FilmItem_filmWrapp__chance__Jyxop",filmWrapp__remove:"_FilmItem_filmWrapp__remove__awY5i",filmWrapp__remove__icon:"_FilmItem_filmWrapp__remove__icon__FojJ1",edit:"_FilmItem_edit__HPm-A",filmWrapp__edit__icon:"_FilmItem_filmWrapp__edit__icon__FiXzi"}},976:(e,i,s)=>{s.d(i,{Z:()=>t});const t={enterActive:"_UserFilms_enterActive__XUbbs",enterDone:"_UserFilms_enterDone__HEx9i",exitActive:"_UserFilms_exitActive__JQWyH",userWrapper:"_UserFilms_userWrapper__P2FOO",userWrapper__title:"_UserFilms_userWrapper__title__sy2s2",userWrapper__remove:"_UserFilms_userWrapper__remove__rhTOB",userWrapper__remove__icon:"_UserFilms_userWrapper__remove__icon__Rax5i","neon-1":"_UserFilms_neon-1__toFhB"}},1332:(e,i,s)=>{s.d(i,{Z:()=>t});const t={FilmsAddingPage__background:"_Adding_FilmsAddingPage__background__BFVMZ",titleContainer:"_Adding_titleContainer__rQ1DK",filmConteinerWrapp__users:"_Adding_filmConteinerWrapp__users__aMzT2",adding__button:"_Adding_adding__button__16Lst","neon-3":"_Adding_neon-3__TGT1N"}}}]);
//# sourceMappingURL=215.14f2c64b.chunk.js.map